import unittest
import sys,os

dir_path = os.path.dirname(os.path.realpath(__file__)) #path to file
parent_dir = os.path.abspath(os.path.join(dir_path, os.pardir)) #path to parent dir of file
src_path = parent_dir+'/src/'
sys.path.insert(0,src_path)

from circuit import circuit

#unit test docs https://docs.python.org/3/library/unittest.html#unittest.TestCase.debug
#run on terminal with python -m unittest test_circuit.py
#or if unittest.main() (see below) to just run python3 test_circuit.py

class test_circuit(unittest.TestCase):

    def test_setSolver(self):
        
        ckt1 = circuit()
        ckt1.makeCkt("t4_21.ckt")
        print ("*----------------------------------------*\n*========================================*")

        self.assertEqual(ckt1.setSolver("10gat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("10gat",1)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("9gat",0)[1], [0,0,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("9gat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("8gat",0)[1], [1,0,1,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("8gat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("7gat",0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("7gat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("6gat",0)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("6gat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("5gat",0)[1], [1,1,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("5gat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("4gat",0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("4gat",1)[1], [0,0,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("3gat",0)[1], [0,1,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("3gat",1)[1], [0,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("2gat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("2gat",1)[1], [1,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("1gat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver("1gat",1)[1], [0,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver(["6gat","3gat"],0)[1], [0,0,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver(["6gat","3gat"],1)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver(["7gat","3gat"],0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt1.setSolver(["7gat","3gat"],1)[1], [1,1,0,1,0])
        print ("----------------------------------------\n========================================")


        ckt2 = circuit()
        ckt2.makeCkt("t4_3.ckt")
        print ("*----------------------------------------*\n*========================================*")

        self.assertEqual(ckt2.setSolver("9gat",0)[1], [0,1,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("9gat",1)[1], [0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("8gat",0)[1], [0,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("8gat",1)[1], [0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("7gat",0)[1], [1,0,1,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("7gat",1)[1], [0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("6gat",0)[1], [0,0,0,1])
        print ("----------------------------------------\n========================================")
 
        self.assertEqual(ckt2.setSolver("6gat",1)[1], [1,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("5gat",0)[1], [1,0,1,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("5gat",1)[1], [1,0,0,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("4gat",0)[1], [0,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("4gat",1)[1], [0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("3gat",0)[1], [1,0,1,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("3gat",1)[1], [1,0,0,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("2gat",0)[1], [1,1,0,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("2gat",1)[1], [1,0,0,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("1gat",0)[1], [1,0,1,0])       # missing last input #fixed
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver("1gat",1)[1], [0,0,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver(["7gat","1gat"],0)[1], [1,0,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver(["7gat","1gat"],1)[1], [0,0,1,0])
        print ("----------------------------------------\n========================================")
        
        self.assertEqual(ckt2.setSolver(["6gat","1gat"],0)[1], [0,0,0,1])        #Not gate fan out
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt2.setSolver(["6gat","1gat"],1)[1], [1,0,0,1])        #Not gate fan out
        print ("----------------------------------------\n========================================")


        ckt3 = circuit()
        ckt3.makeCkt("t5_10.ckt")
        print ("*----------------------------------------*\n*========================================*")

        self.assertEqual(ckt3.setSolver("fgat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("fgat",1)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("mgat",0)[1], [0,0,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("mgat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("kgat",0)[1], [1,0,1,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("kgat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("igat",0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("igat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("jgat",0)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("jgat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("egat",0)[1], [1,1,0,0,1])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("egat",1)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("dgat",0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("dgat",1)[1], [0,0,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("cgat",0)[1], [0,1,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("cgat",1)[1], [0,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("bgat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("bgat",1)[1], [1,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("agat",0)[1], [1,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver("agat",1)[1], [0,1,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver(["jgat","cgat"],0)[1], [0,0,1,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver(["jgat","cgat"],1)[1], [0,0,0,0,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver(["igat","cgat"],0)[1], [0,0,1,1,0])
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt3.setSolver(["igat","cgat"],1)[1], [1,1,0,1,0])
        print ("----------------------------------------\n========================================")
    

        ckt4 = circuit()
        ckt4.makeCkt("t5_26a_v1.ckt")
        # x = 1, y = 2, c = 3
        # 11 = (3 & 1 & 2) | (3 & ~1 & ~2) | ( ~3 & 1 & ~2) | ( ~3 & ~1 & 2)
        print ("*----------------------------------------*\n*========================================*")

        self.assertEqual(ckt4.setSolver("10gat",0)[1], [0,0,0])      #V
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("10gat",1)[1], [0,1,0])      #V
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("9gat",0)[1], [0,0,0])      #U
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("9gat",1)[1], [0,0,1])      #U
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("8gat",0)[1], [0,0,1])      #T
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("8gat",1)[1], [0,1,1])      #T
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["9gat","8gat"],0)[1], [0,0,1])      #T1
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["9gat","8gat"],1)[1], [0,1,1])      #T1
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["10gat","8gat"],0)[1], [0,1,0])      #T2
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["10gat","8gat"],1)[1], [0,1,1])      #T2
        print ("----------------------------------------\n========================================")
        
        self.assertEqual(ckt4.setSolver(["12gat","8gat"],0,1)[1], [0,0,0])      #T3  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["12gat","8gat"],1,1)[1], [0,1,1])      #T3  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("7gat",0)[1], [0,0,0])      #R
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("7gat",0,1)[1], [0,0,1])      #R  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("7gat",1)[1], [0,1,0])      #R
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("7gat",1,1)[1], [0,1,1])      #R  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("6gat",0)[1], [0,0,0])      #Q
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("6gat",0,1)[1], [0,0,1])      #Q  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("6gat",1)[1], [1,0,0])      #Q
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("6gat",1,1)[1], [1,0,1])      #Q  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("5gat",0)[1], [0,1,0])      #N
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("5gat",1)[1], [0,0,0])      #N
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["8gat","5gat"],0)[1], [0,1,1])      #N1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["8gat","5gat"],0,1)[1], [0,1,1])      #N1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["8gat","5gat"],1)[1], [0,0,1])      #N1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["8gat","5gat"],1,1)[1], [0,0,1])      #N1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["10gat","5gat"],0)[1], [0,1,0])      #N2
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["10gat","5gat"],1)[1], [0,0,0])      #N2
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("4gat",0)[1], [0,1,0])      #L
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("4gat",0,1)[1], [0,0,0])      #L  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("4gat",1)[1], [1,1,0])      #L
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("4gat",1,1)[1], [1,1,0])      #L  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["6gat","4gat"],0)[1], [1,0,0])      #L1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["6gat","4gat"],0,1)[1], [1,0,1])      #L1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["6gat","4gat"],1)[1], [1,1,0])      #L1
        print ("----------------------------------------")
        
        self.assertEqual(ckt4.setSolver(["6gat","4gat"],1,1)[1], "UNDETECTABLE!")  #! UNDETECETABLE     #L1  //for detecting CO    XOR fault_free =  False
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["7gat","4gat"],0)[1], [0,1,0])      #L2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["7gat","4gat"],0,1)[1], [0,1,1])      #L2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["7gat","4gat"],1)[1], [1,1,0])      #L2
        print ("----------------------------------------")
        
        self.assertEqual(ckt4.setSolver(["7gat","4gat"],1,1)[1], "UNDETECTABLE!")   #! UNDETECETABLE   #L2  //for detecting CO    XOR fault_free =  False
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["12gat","4gat"],0,1)[1], [0,0,0])      #L3  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["12gat","4gat"],1,1)[1], [1,1,0])      #L3  //for detecting CO
        print ("----------------------------------------\n========================================")
        
        self.assertEqual(ckt4.setSolver("3gat",0)[1], [0,0,1])      #CI
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("3gat",0,1)[1], [0,1,1])      #C  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("3gat",1)[1], [0,0,0])      #CI
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("3gat",1,1)[1], [0,1,0])      #CI  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["9gat","3gat"],0)[1], [0,0,1])      #CI1
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["9gat","3gat"],1)[1], [0,0,0])      #CI1      //possibly wrong
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["8gat","3gat"],0)[1], [0,1,1])      #CI2       //possibly wrong
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["8gat","3gat"],0,1)[1], [0,1,1])      #CI2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["8gat","3gat"],1)[1], [0,1,0])      #CI2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["8gat","3gat"],1,1)[1], [0,1,0])      #CI2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("2gat",0)[1], [0,1,0])      #Y
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("2gat",0,1)[1], [0,1,1])      #Y  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("2gat",1)[1], [0,0,0])      #Y
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("2gat",1,1)[1], [0,0,1])      #Y  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["4gat","2gat"],0)[1], [1,1,0])      #Y1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["4gat","2gat"],0,1)[1], [1,1,0])      #Y1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["4gat","2gat"],1)[1], [1,0,0])      #Y1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["4gat","2gat"],1,1)[1], [1,0,0])      #Y1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["7gat","2gat"],0)[1], [0,1,0])      #Y2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["7gat","2gat"],0,1)[1], [0,1,1])      #Y2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["7gat","2gat"],1)[1], [0,0,0])      #Y2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["7gat","2gat"],1,1)[1], [0,0,1])      #Y2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("1gat",0)[1], [1,0,0])      #X
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("1gat",0,1)[1], [1,0,1])      #X  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver("1gat",1)[1], [0,0,0])      #X
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver("1gat",1,1)[1], [0,0,1])      #X  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["4gat","1gat"],0)[1], [1,1,0])      #X1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["4gat","1gat"],0,1)[1], [1,1,0])      #X1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["4gat","1gat"],1)[1], [0,1,0])      #X1
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["4gat","1gat"],1,1)[1], [0,1,0])      #X1  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["6gat","1gat"],0)[1], [1,0,0])      #X2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["6gat","1gat"],0,1)[1], [1,0,1])      #X2  //for detecting CO
        print ("----------------------------------------\n========================================")

        self.assertEqual(ckt4.setSolver(["6gat","1gat"],1)[1], [0,0,0])      #X2
        print ("----------------------------------------")
        self.assertEqual(ckt4.setSolver(["6gat","1gat"],1,1)[1], [0,0,1])      #X2  //for detecting CO
        print ("----------------------------------------\n========================================")

if __name__ == '__main__':
    unittest.main(exit=False)